# Currently using shodan api directly
# See this link for mroe info: https://developer.shodan.io/api/exploits/rest
#
# python package already exist for shodan api, need to investigate further
# and probably use that for ease of use
# https://shodan.readthedocs.io/en/latest/
# TODO: delete file, leaving for reference for now though



import requests

# This key is registered to cjpoe@asu.edu which got us an academic upgrade
# Limit is 10,000 serach results at a time, up to 20 million searches/month,
# and some other things like shodan maps, images, and their guide book
#
# Maps: https://maps.shodan.io/
# Images: https://images.shodan.io/
# Guide book (downloaded and shared with link):
# https://drive.google.com/file/d/12z6ASUn8vwQIufFca5Np8qNaPqSqgtxJ/view?usp=sharing
key = 'OyiLN1i5O5zjVMUlxQJcT9ok8Fk3Mx2R'

api = 'https://exploits.shodan.io/api/search?'

# test of exploit search given a cve
# cve 2018-4240 is a macOS denial of service (DoS) vulnerability
response = requests.get(api+'query=2018-4240&key='+key)

if response.status_code != 200:
    #error occured
    print(response.status_code, response.headers)

resp_json = response.json()
print(resp_json)
print('\n\n')


print('ID = ', resp_json['matches'][0]['_id'])
print('Description = ', resp_json['matches'][0]['description'])

